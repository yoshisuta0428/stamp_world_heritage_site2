<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ—¥æœ¬ã®ä¸–ç•Œéºç”£ã‚¹ã‚¿ãƒ³ãƒ—ãƒ©ãƒªãƒ¼</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<h1>ğŸ—¾ æ—¥æœ¬ã®ä¸–ç•Œéºç”£ã‚¹ã‚¿ãƒ³ãƒ—ãƒ©ãƒªãƒ¼</h1>

<div class="container">
  <div class="card" id="list"></div>
  <button onclick="generateImage()">ğŸ“¸ ã‚¹ã‚¿ãƒ³ãƒ—å¸³ç”»åƒã‚’ä½œæˆ</button>
</div>

<canvas id="canvas" width="700" height="820"></canvas>

<script>
const heritages = [
  "å§«è·¯åŸ","å±‹ä¹…å³¶","ç™½ç¥å±±åœ°","å¤éƒ½äº¬éƒ½ã®æ–‡åŒ–è²¡",
  "å¤éƒ½å¥ˆè‰¯ã®æ–‡åŒ–è²¡","åŸçˆ†ãƒ‰ãƒ¼ãƒ ","å³å³¶ç¥ç¤¾",
  "æ—¥å…‰ã®ç¤¾å¯º","å¯Œå£«å±±","ç‰çƒç‹å›½ã®ã‚°ã‚¹ã‚¯åŠã³é–¢é€£éºç”£ç¾¤"
];

const positions = {
  "å§«è·¯åŸ": { x: 360, y: 430 },
  "å±‹ä¹…å³¶": { x: 300, y: 560 },
  "ç™½ç¥å±±åœ°": { x: 430, y: 260 },
  "å¤éƒ½äº¬éƒ½ã®æ–‡åŒ–è²¡": { x: 370, y: 400 },
  "å¤éƒ½å¥ˆè‰¯ã®æ–‡åŒ–è²¡": { x: 380, y: 420 },
  "åŸçˆ†ãƒ‰ãƒ¼ãƒ ": { x: 320, y: 460 },
  "å³å³¶ç¥ç¤¾": { x: 330, y: 480 },
  "æ—¥å…‰ã®ç¤¾å¯º": { x: 430, y: 330 },
  "å¯Œå£«å±±": { x: 410, y: 380 },
  "ç‰çƒç‹å›½ã®ã‚°ã‚¹ã‚¯åŠã³é–¢é€£éºç”£ç¾¤": { x: 260, y: 650 }
};

let state = JSON.parse(localStorage.getItem("jpStampMap")) || {};
const list = document.getElementById("list");

function renderList() {
  list.innerHTML = "";
  heritages.forEach(name => {
    const row = document.createElement("div");
    row.className = "item";

    const stamp = document.createElement("div");
    stamp.className = "stamp" + (state[name] ? " checked" : "");
    stamp.textContent = "";

    stamp.onclick = () => {
      state[name] = !state[name];
      localStorage.setItem("jpStampMap", JSON.stringify(state));
      renderList();
    };

    const label = document.createElement("div");
    label.textContent = name;

    row.appendChild(stamp);
    row.appendChild(label);
    list.appendChild(row);
  });
}

function drawStamp(ctx, x, y) {
  const size = 36;
  const half = size/2;
  ctx.strokeStyle = "#c62828";
  ctx.lineWidth = 4;
  ctx.beginPath();
  ctx.moveTo(x - half/2, y);
  ctx.lineTo(x, y + half/2);
  ctx.lineTo(x + half, y - half/2);
  ctx.stroke();
}

function generateImage() {
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  const mapImg = new Image();
  mapImg.src = "japan_map.png";

  mapImg.onload = () => {
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // èƒŒæ™¯
    ctx.fillStyle = "#faf7f2";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // ã‚¿ã‚¤ãƒˆãƒ«
    ctx.font = "26px sans-serif";
    ctx.fillStyle = "#000";
    ctx.textAlign = "center";
    ctx.fillText("æ—¥æœ¬ã®ä¸–ç•Œéºç”£ã‚¹ã‚¿ãƒ³ãƒ—å¸³", canvas.width / 2, 40);

    // åœ°å›³
    ctx.drawImage(mapImg, 0, 80, 700, 650);

    // ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯æç”»
    Object.keys(state).forEach(name => {
      if (state[name] && positions[name]) {
        drawStamp(ctx, positions[name].x, positions[name].y);
      }
    });

    // æ—¥ä»˜
    ctx.font = "14px sans-serif";
    ctx.fillStyle = "#555";
    ctx.textAlign = "right";
    ctx.fillText(new Date().toLocaleDateString(), 680, 800);
  };
}

renderList();
</script>

</body>
</html>

